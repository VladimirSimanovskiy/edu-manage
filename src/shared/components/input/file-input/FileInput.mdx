import { Canvas, Meta, Controls, Description } from "@storybook/blocks";
import * as ComponentStories from "./FileInput.stories";

<Meta of={ComponentStories} />

# FileInput

`FileInput` компонент для загрузки файла.

- Работает как в controlled, так и в uncontrolled режиме
- Поддерживает два типа файлов: `File` (браузерный) и `FileInfo` (серверный)
- Включает кнопки очистки и скачивания
- Настраиваемый placeholder и текст кнопки

## Базовое использование

<Canvas of={ComponentStories.Default} />

```tsx
import { FileInput } from "ics-ui-kit/components/input";

export const Basic = () => {
	<FileInput onChange={(file) => console.log(file)} />;
};
```

## Свойства

<Controls of={ComponentStories.Default} />

## Режимы работы

### Controlled режим

Используйте проп `value` для полного контроля над состоянием:

```tsx
const [file, setFile] = useState<FileValue>(null);
<FileInput value={file} onChange={setFile} />;
```

### Uncontrolled режим

Используйте проп `defaultValue` для инициализации:

```tsx
<FileInput defaultValue={someFile} onChange={(file) => console.log(file)} />
```

## Функционал скачивания

Компонент автоматически определяет тип файла и применяет соответствующую логику скачивания:

- **Для браузерных File объектов**: создает blob URL и скачивает файл из памяти браузера
- **Для FileInfo с URL**: скачивает файл по указанному URL

Кнопка скачивания появляется автоматически когда:

- Выбран любой файл (File или FileInfo с URL)
- Компонент не заблокирован

## Примеры использования

### Только изображения

<Canvas of={ComponentStories.ImageOnly} />

### Заблокированное состояние

<Canvas of={ComponentStories.Disabled} />

### Контролируемый режим

<Canvas of={ComponentStories.Controlled} />

```tsx
import { useState } from "react";
import { FileInput, type FileValue } from "ics-ui-kit/components/input";

export const Controlled = () => {
	const [selectedFile, setSelectedFile] = useState<FileValue>(null);

	return (
		<FileInput
			value={selectedFile}
			onChange={setSelectedFile}
			placeholder="Файл не выбран"
			chooseButtonText="Choose file"
		/>
	);
};
```

### С предустановленным значением (uncontrolled)

<Canvas of={ComponentStories.WithDefaultValue} />

### С FileInfo объектом

<Canvas of={ComponentStories.WithFileInfo} />

#### Типы данных

```tsx
export interface FileInfo {
	/** Имя файла */
	name: string;
	/** URL для скачивания или просмотра файла */
	url?: string;
	/** Размер файла в байтах (опционально) */
	size?: number;
	/** MIME-тип файла (опционально) */
	type?: string;
}

export type FileValue = File | FileInfo | null;
```

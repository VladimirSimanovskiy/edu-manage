import { Canvas, Meta, Controls, Description } from "@storybook/blocks";
import * as ComponentStories from "./Form.stories";

<Meta of={ComponentStories} />

# Form

`Form` - это компонент для создания форм, предоставляет удобный способ управления состоянием формы, валидацией и обработкой отправки данных.

- Основан на [react-hook-form](https://react-hook-form.com/)
- Интегрируется с [zod](https://zod.dev/) для валидации
- Обеспечивает правильную фокусировку и навигацию с клавиатуры
- Поддерживает скринридеры
- Обеспечивает правильную последовательность фокуса

[Ссылка на Figma](https://www.figma.com/design/lc2aOtrukFLJQwxxgH3Cgm/UI-kit?node-id=20879-86621&m=dev)

## Структура компонента

Компонент состоит из нескольких частей:

- `Form` - основной контейнер формы
- `FormItem` - контейнер для элементов формы
- `FormLabel` - лейбл для поля формы
- `FormControl` - контрол для поля формы
- `FormMessage` - сообщение об ошибке
- `FormFieldControl` - контроллер поля формы
- `FormField` - поле формы с валидацией
- `FormDescription` - описание поля
- `FormTitle` - заголовок поля
- `FormHeader` - заголовок формы
- `FormSectionTitle` - заголовок секции формы
- `FormBody` - тело формы
- `FormFooter` - футер формы
- `FormDivider` - девайдер формы
- `FormStack` - оболочка для группы полей формы с внутренними отступами
- `FormFieldSet` - оболочка для группы полей формы с рамкой и внутренними отступами
- `FormSectionHeaderButton` - кнопка для отдельной секции
- `FormHeaderTemplate` - темплейт заголовка формы. Содержит иконку, заголовок и описание. Имеет различные варианты расположения элементов
- `FormFooterTemplate` - темплейт футера формы. Содержит чекбокс и 2 кнопки, которыми можно управлять. Адаптивен к размерам устройств

### Базовое использование

<Canvas of={ComponentStories.Default} />

```tsx
import {
	Form,
	FormFieldControl,
	FormItem,
	FormLabel,
	FormControl,
	FormDescription,
	FormMessage,
	FormStack
} from "ics-ui-kit/components/form";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { z } from "zod";
import { TextInput } from "ics-ui-kit/components/input";
import { Icon } from "ics-ui-kit/components/icon";
import { Button } from "ics-ui-kit/components/button";
import { User, Mail } from "lucide-react";

const formSchema = z.object({
	username: z.string().min(2, {
		message: "Имя пользователя должно содержать минимум 2 символа"
	}),
	email: z.string().email({
		message: "Введите корректный email"
	})
});

export const BasicForm = () => {
	const form = useForm<z.infer<typeof formSchema>>({
		resolver: zodResolver(formSchema),
		defaultValues: {
			username: "",
			email: ""
		}
	});

	function onSubmit(values: z.infer<typeof formSchema>) {
		console.log(values);
	}

	return (
		<Form {...form}>
			<form onSubmit={form.handleSubmit(onSubmit)}>
				<FormBody>
					<FormStack>
						<FormFieldControl
							control={form.control}
							name="username"
							render={({ field }) => (
								<FormItem>
									<FormLabel>Имя пользователя</FormLabel>
									<FormControl>
										<TextInput
											placeholder="Введите имя пользователя"
											startIcon={<Icon icon={User} />}
											{...field}
										/>
									</FormControl>
									<FormDescription>Ваше публичное имя пользователя</FormDescription>
									<FormMessage />
								</FormItem>
							)}
						/>
						<FormFieldControl
							control={form.control}
							name="email"
							render={({ field }) => (
								<FormItem>
									<FormLabel>Email</FormLabel>
									<FormControl>
										<TextInput
											placeholder="Введите email"
											type="email"
											startIcon={<Icon icon={Mail} />}
											{...field}
										/>
									</FormControl>
									<FormDescription>Мы никогда не передадим ваш email третьим лицам</FormDescription>
									<FormMessage />
								</FormItem>
							)}
						/>

						<div className="flex flex-col gap-0.5">
							<div className="flex flex-row items-center justify-between gap-3 lg:gap-4">
								<FormSectionTitle>Дополнительные поля</FormSectionTitle>
								<FormSectionHeaderButton
									variant="text"
									type="button"
									onClick={() => console.log("Добавлено новое поле")}
								>
									Добавить новое поле
								</FormSectionHeaderButton>
							</div>
							<Description>Это описание дополнительного поля</Description>
						</div>
					</FormStack>
				</FormBody>

				<FormFooter>
					<Button type="submit">Отправить</Button>
				</FormFooter>
			</form>
		</Form>
	);
};
```

### Форма без рамок в шапке и футере

<Canvas of={ComponentStories.WithoutBorders} />

### Форма с использованием FormFieldSet

<Canvas of={ComponentStories.WithFieldSet} />

### Форма с переключателями и чекбоксами без рамки

<Canvas of={ComponentStories.FormWithSwitchesAndCheckboxes} />

### Форма с различными полями для граммакса

<Canvas of={ComponentStories.TemplateFormPlayground} />
